<!DOCTYPE html>
<html>
<title>Post a Plant</title>
<head>

<!-- Latest compiled and minified CSS -->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">

<!-- jQuery library -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>

<!-- Popper JS -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"></script>

<!-- Latest compiled JavaScript -->
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>
<link rel="stylesheet" href="plantStyle.css">

<!-- Brought in From overview -->
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no"/>
<meta name="msapplication-tap-highlight" content="no" />
<meta name="theme-color" content="#FFB300" />
<title>Find My Flora Front-End</title>
<link rel="stylesheet" href="./reset.css">
<link rel="stylesheet" href="./styles.css">
<!--  -->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css" integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous">
<!-- jquery stuff -->
<script src="https://code.jquery.com/jquery-1.12.4.js"></script>
<script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
<!-- -->
<link href="http://www.jqueryscript.net/css/jquerysctipttop.css" rel="stylesheet" type="text/css">
<link rel="shortcut icon" href="./assets/favicon.ico" type="image/x-icon" />
<!--  -->
</head>

<body>
  <header class="header">
    <div class="header__container">
      <!-- svg hamburger icon -->
      <div class="menu__icon">
        <svg width="24px" height="24px" viewBox="0 0 48 48" fill=black>
          <path d="M6 36h36v-4H6v4zm0-10h36v-4H6v4zm0-14v4h36v-4H6z"></path>
        </svg>
      </div>


    </div>



  </header>

  <!-- menu  -->
  <nav class="menu">
    <div class="menu__header">
      <center>
        <img src="assets/fmf-logo2.png" height = 275px>
      </center>
    </div>
    <ul class="menu__list">
      <a href="overview.html"> <li > Home </li> </a>
      <a href="account.html"><li> Account </li></a>
      <a href="postPlant.html"> <li class="currentMenuSelection"> Post a Plant </li> </a>
      <a href="searchPlant.html"> <li> Find a Plant </li> </a>
      <a href="beeMode.html"> <li> Bee Mode </li> </a>
    <ul>
  </nav>

<div class="main-box">

  <!-- overlay  -->
<div class="menu__overlay"></div>
  <div class="main-container">


      <div class="myBox">
        <!-- <div class = "page"> -->
        <div class="postPlantBox">
          <center>
            <h1>Post a Plant</h1>
          </center>

            <div class = "data-entry">
            <div class="form-group">
                <p class = "input-label">Plant Name</p>
                <input type="text" class="form-control" id="name">
            </div>
            
            <row>
              <div class = "col lg-3">
                Features
              </div>
              <div class = "col lg-9">
                <div class="form-check form-check-inline">
                  <input class="form-check-input" type="checkbox" id="thorns_feature" value="thorns" name = "feature">
                  <label class="form-check-label" for="thorns_feature">Thorns</label>
                </div>
                <div class="form-check form-check-inline">
                  <input class="form-check-input" type="checkbox" id="spines_feature" value="spines" name = "feature">
                  <label class="form-check-label" for="spines_feature">Spines</label>
                </div>
                <div class="form-check form-check-inline">
                  <input class="form-check-input" type="checkbox" id="succulent_feature" value="succulent" name = "feature">
                  <label class="form-check-label" for="succulent_feature">Succulent</label>
                </div>
                <div class="form-check form-check-inline">
                  <input class="form-check-input" type="checkbox" id="leafy_feature" value="leafy" name = "feature">
                  <label class="form-check-label" for="leafy_feature">Leafy</label>
                </div>
                <div class="form-check form-check-inline">
                  <input class="form-check-input" type="checkbox" id="bark_feature" value="bark" name = "feature">
                  <label class="form-check-label" for="bark_feature">Bark</label>
                </div>
                <div class="form-check form-check-inline">
                  <input class="form-check-input" type="checkbox" id="none_feature" value="none" name = "feature">
                  <label class="form-check-label" for="none_feature">None Apply</label>
                </div>
              </div>
            </row>
            <row>
              <div class = "col lg-3">
                Colors
              </div>
              <div class = "col lg-9">
                <div class="form-check form-check-inline">
                  <input class="form-check-input" type="checkbox" id="red_color" value="red" name = "color">
                  <label class="form-check-label" for="red_color">Red</label>
                </div>
                <div class="form-check form-check-inline">
                  <input class="form-check-input" type="checkbox" id="orange_color" value="orange" name = "color">
                  <label class="form-check-label" for="orange_color">Orange</label>
                </div>
                <div class="form-check form-check-inline">
                  <input class="form-check-input" type="checkbox" id="yellow_color" value="yellow" name = "color">
                  <label class="form-check-label" for="yellow_color">Yellow</label>
                </div>
                <div class="form-check form-check-inline">
                  <input class="form-check-input" type="checkbox" id="green_color" value="green" name = "color">
                  <label class="form-check-label" for="green_color">Green</label>
                </div>
                <div class="form-check form-check-inline">
                  <input class="form-check-input" type="checkbox" id="blue_color" value="blue" name = "color">
                  <label class="form-check-label" for="blue_color">Blue</label>
                </div>
                <div class="form-check form-check-inline">
                  <input class="form-check-input" type="checkbox" id="violet_color" value="violet" name = "color">
                  <label class="form-check-label" for="violet_color">Violet</label>
                </div>
                <div class="form-check form-check-inline">
                    <input class="form-check-input" type="checkbox" id="pink_color" value="pink" name = "color">
                    <label class="form-check-label" for="pink_color">Pink</label>
                  </div>
                <div class="form-check form-check-inline">
                  <input class="form-check-input" type="checkbox" id="white_color" value="white" name = "color">
                  <label class="form-check-label" for="white_color">White</label>
                </div>
                <div class="form-check form-check-inline">
                  <input class="form-check-input" type="checkbox" id="black_color" value="black" name = "color">
                  <label class="form-check-label" for="black_color">Black</label>
                </div>
                <div class="form-check form-check-inline">
                  <input class="form-check-input" type="checkbox" id="none_color" value="none" name = "color">
                  <label class="form-check-label" for="none_color">None Apply</label>
                </div>
              </div>
            </row>
            <row>
              <div class = "col lg-3">
                Type
              </div>
              <div class = "col lg-9">
                <div class="form-check form-check-inline">
                  <input class="form-check-input" type="checkbox" id="flower_type" value="flower" name = "type">
                  <label class="form-check-label" for="flower_type">Flower</label>
                </div>
                <div class="form-check form-check-inline">
                  <input class="form-check-input" type="checkbox" id="tree_type" value="tree" name = "type">
                  <label class="form-check-label" for="tree_type">Tree</label>
                </div>
                <div class="form-check form-check-inline">
                  <input class="form-check-input" type="checkbox" id="shrub_type" value="shrub" name = "type">
                  <label class="form-check-label" for="shrub_type">Shrub</label>
                </div>
                <div class="form-check form-check-inline">
                    <input class="form-check-input" type="checkbox" id="none_type" value="none" name = "type">
                    <label class="form-check-label" for="none_type">None Apply</label>
                  </div>
              </div>
            </row>
                <br/>
                <div class="form-group">
                    <input type="file" onchange="previewFile()"><br>
                  <img src="" id = "preview-image" height="200" alt="image">
                </div>
                <hr/>
                <button class = "btn btn-primary" id = "locator" onclick = "getLocation()">Locate Plant</button>
                <p class = "success_location"></p>
                <div class="form-group">
                    <label for="comment">Location Description:</label>
                    <textarea class="form-control" rows="3" id="location_description"></textarea>
                </div>
                <div class="form-group">
                    <label for="comment">Plant Review:</label>
                    <textarea class="form-control" rows="5" id="plant_review"></textarea>
                </div>

                
                <hr/>
                <button type="button" class="btn btn-primary" id = "submit_plant">Submit Plant</button>
                
                
            </div>
        <!-- </div> -->
      </div>
      
    </div>


    </div>




    </div>
  </div>




    <script>
      var imgurl;
      function previewFile() {
        console.log("gonna preview file");
        var preview = document.getElementById('preview-image');
        var file    = document.querySelector('input[type=file]').files[0];
        var reader  = new FileReader();

        reader.addEventListener("load", function () {
          preview.src = reader.result;
          imgurl = reader.result;
        }, false);

        if (file) {
          reader.readAsDataURL(file);
        }
      }
      //var x = document.getElementById("demo");
      function getLocation() {
        if (navigator.geolocation) {
          navigator.geolocation.getCurrentPosition(showPosition);
        } else {
          x.innerHTML = "Geolocation is not supported by this browser.";
        }
      }
      var geo;
      /*
      $("#locator").click((success)=>{
        geo = navigator.geolocation;
        var coords = geo.getCurrentPosition();
        
      });
      */
      var latitude;
      var longitude;
      function showPosition(position) {
        latitude = position.coords.latitude;
        longitude = position.coords.longitude;
        $(".success_location").text("Success!");
        console.log("latitude: ", latitude);
        console.log("longitude: ", longitude);
      }
      function success(pos) {
        var crd = pos.coords;

        console.log('Your current position is:');
        console.log(`Latitude : ${crd.latitude}`);
        console.log(`Longitude: ${crd.longitude}`);
        console.log(`More or less ${crd.accuracy} meters.`);
      }
      
      $("#submit_plant").click(()=>{
        var colors = [];
        var features = [];
        var types = [];
        $.each($("input[name='color']:checked"), function(){
            colors.push($(this).val());
        });
        $.each($("input[name='feature']:checked"), function(){
            features.push($(this).val());
        });
        $.each($("input[name='type']:checked"), function(){
            types.push($(this).val());
        });
        //var myurl = document.getElementById("photo_input").getElementsByTagName("img")[0].src;   
        //alert(myurl);
        //var end_url;
        console.log("url of image: ", imgurl);
        //convertToDataURLviaCanvas(imgurl, end_url);
        //console.log(favorite);
        var form_object = {
          "name": $('#name').val(),
          "features": features,
          "colors": colors,
          "types": types,
          "xCord": longitude,
          "yCord": latitude,
          "imageFile": imgurl,
          "location_description": $("#location_description").val(),
          "plant_review": $("#plant_review").val()
        };
        console.log("form object", form_object);
        $.ajax({
          url: 'http://localhost:5000/submit/',
          headers: {
              "Access-Control-Allow-Origin": "*",
          },
          contentType: 'application/json',
          method: 'POST',
          dataType: 'json',
          data: JSON.stringify(form_object),
          success: function(data) {
              console.log(data);
              
          },
          error: function(jqXhr, textStatus, errorThrown) {
              console.log(errorThrown)
          }
        });
      });

      function convertToDataURLviaCanvas(url, callback, outputFormat){
          var img = new Image();
          img.crossOrigin = 'Anonymous';
          img.onload = function(){
              var canvas = document.createElement('CANVAS');
              var context = canvas.getContext('2d');
              var dataURL;
              canvas.height = this.height;
              canvas.width = this.width;
              context.drawImage(this, 0, 0);
              dataURL = canvas.toDataURL(outputFormat);
              callback(dataURL);
              canvas = null; 
          };
          img.src = url;
      }

      //convertToDataURLviaCanvas('http://bit.ly/18g0VNp', function(base64Img){
    // Base64DataURL
      //});
      /*
      
        */
        
    </script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script type="text/javascript" src="./app.js"></script>
    <link rel="stylesheet" href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/themes/smoothness/jquery-ui.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>
    <script src="scripts.js">  </script>

    <script src="http://code.jquery.com/jquery-1.12.0.min.js"></script>


  </body>
  </html>
